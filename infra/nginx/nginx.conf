server {
    listen 80;

    # --- Servicios (Manteniendo clients, products, sales en la URL) ---

    location /api/v1/clients {
        # ¡IMPORTANTE! Se quita el '/' final en el proxy_pass para mantener la ruta completa.
        proxy_pass http://clientes-service:3000/api/v1/clients; 
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location /api/v1/products {
        # ¡IMPORTANTE! Se quita el '/' final en el proxy_pass para mantener la ruta completa.
        # Se añade 'products' para completar la ruta base.
        proxy_pass http://productos-service:3000/api/v1/products; 
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location /api/v1/sales {
        # ¡IMPORTANTE! Se quita el '/' final en el proxy_pass para mantener la ruta completa.
        # Se añade 'sales' para completar la ruta base.
        proxy_pass http://ventas-service:3000/api/v1/sales; 
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # --- Documentación Swagger (Sin Cambios Adicionales) ---

    location /api-docs/clients {
        proxy_pass http://clientes-service:3000/api-docs/clients;
    }

    location /api-docs/products {
        proxy_pass http://productos-service:3000/api-docs/products;
    }

    location /api-docs/sales {
        proxy_pass http://ventas-service:3000/api-docs/sales;
    }
}